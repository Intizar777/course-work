CREATE DATABASE MENU;
USE MENU;

CREATE TABLE Dish_category (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE Dish (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    weight INT,
    price DECIMAL(10, 2) NOT NULL CHECK (price > 0),
    id_category INT NOT NULL,
    FOREIGN KEY (id_category) REFERENCES Dish_category(id) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE Ingredients (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE,
    unit VARCHAR(20)
);

CREATE TABLE Dish_Ingredients (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_dish INT NOT NULL,
    id_ingredient INT NOT NULL,
    FOREIGN KEY (id_dish) REFERENCES Dish(id) ON DELETE CASCADE,
    FOREIGN KEY (id_ingredient) REFERENCES Ingredients(id) ON DELETE CASCADE
);

CREATE TABLE Menu (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE Dish_Menu (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_dish INT NOT NULL,
    id_menu INT NOT NULL,
    FOREIGN KEY (id_dish) REFERENCES Dish(id) ON DELETE CASCADE,
    FOREIGN KEY (id_menu) REFERENCES Menu(id) ON DELETE CASCADE
);
